scale_y_continuous(name = "Mean ozone in\nparts per billion",
breaks = seq(0, 175, 25), limits = c(0, 175)) +
scale_x_discrete(name = "Month") +
labs(title = "Frequency histogram of mean ozone",
subtitle = "Source: New York State Department of Conservation") +
theme_fivethirtyeight() + scale_fill_fivethirtyeight() +
theme(axis.title = element_text(family = "Atlas Grotesk Regular"),
legend.position = "bottom",
legend.direction = "horizontal",
legend.box = "horizontal",
legend.title = element_text(family = "Atlas Grotesk Regular", size = 10),
legend.text = element_text(family = "Atlas Grotesk Regular", size = 10),
plot.title = element_text(family = "Atlas Grotesk Medium"),
text = element_text(family = "Decima Mono Pro"))
p10
# my own theme
fill <- "#4271AE"; lines <- "#1F3552"
p10 <- ggplot(airquality, aes(x = Month, y = Ozone)) +
geom_boxplot(colour = lines, fill = fill,
size = 1) +
scale_y_continuous(name = "Mean ozone in\nparts per billion",
breaks = seq(0, 175, 25), limits = c(0, 175)) +
scale_x_discrete(name = "Month") +
labs(title = "Frequency histogram of mean ozone",
subtitle = "Source: New York State Department of Conservation") +
theme_bw() +
theme(panel.border = element_rect(colour = "black", fill = NA, size = .5),
panel.grid.major = element_line(colour = "#d3d3d3"),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
plot.title = element_text(size = 14, family = "Tahoma", face = "bold"),
text = element_text(family = "Tahoma"),
axis.title = element_text(face = "bold"),
axis.text.x = element_text(colour = "black", size = 11),
axis.text.y = element_text(colour = "black", size = 9))
p10
# Boxplot extras
p10 <- p10 + geom_jitter()
p10
p10 <- ggplot(airquality, aes(x = Month, y = Ozone)) +
geom_boxplot(colour = lines, fill = fill,
size = 1, outlier.colour = "#1F3552", outlier.shape = 20) +
scale_y_continuous(name = "Mean ozone in\nparts per billion",
breaks = seq(0, 175, 25), limits = c(0, 175)) +
scale_x_discrete(name = "Month") +
labs(title = "Frequency histogram of mean ozone",
subtitle = "Source: New York State Department of Conservation") +
theme_bw() +
theme(panel.border = element_rect(colour = "black", fill = NA, size = .5),
panel.grid.major = element_line(colour = "#d3d3d3"),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
plot.title = element_text(size = 14, family = "Tahoma", face = "bold"),
text = element_text(family = "Tahoma"),
axis.title = element_text(face = "bold"),
axis.text.x = element_text(colour = "black", size = 11),
axis.text.y = element_text(colour = "black", size = 9))
p10
# Boxplot extras
p10 <- p10 + geom_jitter()
p10
# Boxplot extras
p10 <- p10 + geom_jitter(outlier.colour = "#1F3552", outlier.shape = 20)
p10 <- ggplot(airquality, aes(x = Month, y = Ozone)) +
geom_boxplot(colour = lines, fill = fill,
size = 1) +
scale_y_continuous(name = "Mean ozone in\nparts per billion",
breaks = seq(0, 175, 25), limits = c(0, 175)) +
scale_x_discrete(name = "Month") +
labs(title = "Frequency histogram of mean ozone",
subtitle = "Source: New York State Department of Conservation") +
theme_bw() +
theme(panel.border = element_rect(colour = "black", fill = NA, size = .5),
panel.grid.major = element_line(colour = "#d3d3d3"),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
plot.title = element_text(size = 14, family = "Tahoma", face = "bold"),
text = element_text(family = "Tahoma"),
axis.title = element_text(face = "bold"),
axis.text.x = element_text(colour = "black", size = 11),
axis.text.y = element_text(colour = "black", size = 9))
p10
# Boxplot extras
p10 <- p10 + geom_jitter()
p10
setwd("D:/R/exercise/box plots")
getwd()
# Boxplot extras
p10 <- p10 + geom_jitter()
p10
p10 <- ggplot(airquality, aes(x = Month, y = Ozone)) +
geom_boxplot(colour = lines, fill = fill,
size = 1, notch = TRUE) +
scale_y_continuous(name = "Mean ozone in\nparts per billion",
breaks = seq(0, 175, 25), limits = c(0, 175)) +
scale_x_discrete(name = "Month") +
labs(title = "Frequency histogram of mean ozone",
subtitle = "Source: New York State Department of Conservation") +
theme_bw() +
theme(panel.border = element_rect(colour = "black", fill = NA, size = .5),
panel.grid.major = element_line(colour = "#d3d3d3"),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
plot.title = element_text(size = 14, family = "Tahoma", face = "bold"),
text = element_text(family = "Tahoma"),
axis.title = element_text(face = "bold"),
axis.text.x = element_text(colour = "black", size = 11),
axis.text.y = element_text(colour = "black", size = 9))
p10
p10 <- ggplot(airquality, aes(x = Month, y = Ozone)) +
geom_boxplot(colour = lines, fill = fill,
size = 1, notch = TRUE) +
# notch = TRUE 参数创建带有凹槽的箱线图时，可以通过观察凹槽是否重叠来判断中位数之间是否有显著差异
scale_y_continuous(name = "Mean ozone in\nparts per billion",
breaks = seq(0, 175, 25), limits = c(0, 175)) +
scale_x_discrete(name = "Month") +
labs(title = "Frequency histogram of mean ozone",
subtitle = "Source: New York State Department of Conservation") +
theme_bw() +
theme(panel.border = element_rect(colour = "black", fill = NA, size = .5),
panel.grid.major = element_line(colour = "#d3d3d3"),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
plot.title = element_text(size = 14, family = "Tahoma", face = "bold"),
text = element_text(family = "Tahoma"),
axis.title = element_text(face = "bold"),
axis.text.x = element_text(colour = "black", size = 11),
axis.text.y = element_text(colour = "black", size = 9))
p10
# Grouping by another variable
airquality_trimmed <- airquality %>%
filter(Month %in% c("Jul", "Aug", "Sep")) %>%
mutate(Temp.f = factor(ifelse(Temp > mean(Temp), 1, 0),
labels = c("Low temp ", "High temp ")))
p10 <- ggplot(airquality_trimmed, aes(x = Month, y = Ozone)) +
geom_boxplot(fill = fill, colour = line,
alpha = 0.7) +
scale_y_continuous(name = "Mean ozone in\nparts per billion",
breaks = seq(0, 175, 50), limits = c(0, 175)) +
scale_x_discrete(name = "Month") +
labs(title = "Frequency histogram of mean ozone",
subtitle = "Source: New York State Department of Conservation") +
theme_bw() +
theme(plot.title = element_text(size = 14, family = "Tahoma", face = "bold"),
panel.border = element_rect(colour = "black", fill = NA, size = .5),
text = element_text(size = 12, family = "Tahoma"),
axis.title = element_text(face = "bold"),
axis.text.x = element_text(size = 11)) +
facet_grid(. ~ Temp.f)
p10
p10 <- ggplot(airquality_trimmed, aes(x = Month, y = Ozone, fill = Temp.f)) +
geom_boxplot(alpha = 0.7) +
scale_y_continuous(name = "Mean ozone in\nparts per billion",
breaks = seq(0, 175, 25), limits = c(0, 175)) +
scale_x_discrete(name = "Month") +
labs(title = "Frequency histogram of mean ozone",
subtitle = "Source: New York State Department of Conservation") +
theme_bw() +
theme(plot.title = element_text(size = 14, family = "Tahoma", face = "bold"),
panel.border = element_rect(colour = "black", fill = NA, size = .5),
text = element_text(size = 12, family = "Tahoma"),
axis.title = element_text(face = "bold"),
axis.text.x = element_text(size = 11)) +
scale_fill_brewer(palette = "Accent")
p10
# Formatting the legend
p10 <- ggplot(airquality_trimmed, aes(x = Month, y = Ozone, fill = Temp.f)) +
geom_boxplot(alpha = 0.7) +
scale_y_continuous(name = "Mean ozone in\nparts per billion",
breaks = seq(0, 175, 25), limits = c(0, 175)) +
scale_x_discrete(name = "Month") +
labs(title = "Frequency histogram of mean ozone",
subtitle = "Source: New York State Department of Conservation") +
theme_bw() +
theme(plot.title = element_text(size = 14, family = "Tahoma", face = "bold"),
panel.border = element_rect(colour = "black", fill = NA, size = .5),
text = element_text(size = 12, family = "Tahoma"),
axis.title = element_text(face = "bold"),
axis.text.x = element_text(size = 11),
legend.position = "bottom") +
scale_fill_brewer(palette = "Accent") +
labs(fill = "Temperature ")
p10
setwd("D:/R/exercise/linear regression plot")
setwd()
getwd()
rm(list = lm())
rm(list = ls())
if (!require("pacman")) install.packages("pacman")
p_load(ggplot2, ggthemes, grid, dplyr, HistData)
p_load_gh("sinhrks/ggfortify")
Galton <- as_tibble(Galton)
# Trend line plot
# Basic trend line plot
fit <- lm(child ~ parent, data = Galton)
summary(fit)
p11 <- ggplot(Galton, aes(x = parent, y = child)) +
geom_point(shape = 1) + geom_smooth(method = lm)
p11
p11 <- ggplot(Galton, aes(x = parent, y = child)) +
geom_point(shape = 1) + geom_smooth(method = lm, se = FALSE)
p11
# Customising axis labels
p11 <- p11 + scale_x_continuous(name = "Parent height") +
scale_y_continuous(name = "Child height")
p11
# Adding a title
p11 <- p11 +
labs(title = "Galton regression line",
subtitle = "Source: R Core Team")
p11
# Using the white theme
p11 <- p11 + theme_bw()
p11
# Using ‘The Economist’ theme
p11 <- ggplot(Galton, aes(x = parent, y = child)) +
geom_point(shape = 1) + geom_smooth(method = lm, se = FALSE) +
labs(title = "Galton regression line",
subtitle = "Source: R Core Team") +
scale_x_continuous(name = "Parent height") +
scale_y_continuous(name = "Child height") +
theme_economist() + scale_fill_economist() +
theme(axis.line.x = element_line(size = .5, colour = "black"),
axis.title = element_text(size = 12),
legend.position = "bottom",
legend.direction = "horizontal",
legend.box = "horizontal",
legend.text = element_text(size = 10),
text = element_text(family = "Roboto Condensed"),
plot.title = element_text(family = "Roboto Condensed"))
p11
# Using ‘Five Thirty Eight’ theme
p11 <- ggplot(Galton, aes(x = parent, y = child)) +
geom_point(shape = 1) + geom_smooth(method = lm, se = FALSE) +
labs(title = "Galton regression line",
subtitle = "Source: R Core Team") +
scale_x_continuous(name = "Parent height") +
scale_y_continuous(name = "Child height") +
theme_fivethirtyeight() + scale_fill_fivethirtyeight() +
theme(axis.title = element_text(family = "Atlas Grotesk Regular"),
legend.position = "bottom",
legend.direction = "horizontal",
legend.box = "horizontal",
legend.title = element_text(family = "Atlas Grotesk Regular", size = 10),
legend.text = element_text(family = "Atlas Grotesk Regular", size = 10),
plot.title = element_text(family = "Atlas Grotesk Medium"),
text = element_text(family = "Decima Mono Pro"))
p11
# my own
p11 <- ggplot(Galton, aes(x = parent, y = child)) +
geom_point(shape = 1) + geom_smooth(method = lm, se = FALSE) +
labs(title = "Galton regression line",
subtitle = "Source: R Core Team") +
scale_x_continuous(name = "Parent height") +
scale_y_continuous(name = "Child height") +
theme(panel.border = element_rect(colour = "black", fill = NA, size = .5),
axis.text.x = element_text(colour = "black", size = 9),
axis.text.y = element_text(colour = "black", size = 9),
legend.position = "bottom",
legend.direction = "horizontal",
legend.box = "horizontal",
panel.grid.major = element_line(colour = "#d3d3d3"),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
plot.title = element_text(size = 14, family = "Tahoma", face = "bold"),
text = element_text(family = "Tahoma"))
p11
# Regression diagnostics plots
# Basic diagnostics plots
autoplot(fit, label.size = 3)
# Using the white theme
autoplot(fit, label.size = 3) + theme_bw()
# Using ‘The Economist’ theme
autoplot(fit, label.size = 3) + theme_economist() +
theme(panel.border = element_rect(colour = "black",
fill = NA, size = .5),
axis.text.x = element_text(colour = "black", size = 9),
axis.text.y = element_text(colour = "black", size = 9),
panel.background = element_blank(),
plot.title = element_text(family = "Roboto Condensed"),
text = element_text(family = "Roboto Condensed"))
# Using ‘Five Thirty Eight’ theme
autoplot(fit, label.size = 3) + theme_fivethirtyeight() +
theme(axis.title = element_text(family = "Atlas Grotesk Regular"),
axis.text.x = element_text(colour = "black", size = 9),
axis.text.y = element_text(colour = "black", size = 9),
legend.position = "bottom",
legend.direction = "horizontal",
legend.box = "horizontal",
plot.title = element_text(family = "Atlas Grotesk Medium", size = 12),
text = element_text(family = "Decima Mono Pro"))
# my own
autoplot(fit, label.size = 3) +
theme(panel.border = element_rect(colour = "black", fill = NA, size = .5),
axis.text.x = element_text(colour = "black", size = 9),
axis.text.y = element_text(colour = "black", size = 9),
legend.position = "bottom",
legend.direction = "horizontal",
legend.box = "horizontal",
panel.grid.major = element_line(colour = "#d3d3d3"),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
plot.title = element_text(size = 14, family = "Tahoma", face = "bold"),
text = element_text(family = "Tahoma"))
lm(list(ls()))
rm(list(ls()))
rm(list = ls())
setwd("D:/R/exercise/LOWESS plots")
getwd()
if (!require("pacman")) install.packages("pacman")
p_load(datasets, ggplot2, ggthemes, grid, RColorBrewer)
data(airquality)
# 画LOWESS图
p12 <- ggplot(airquality, aes(x = Temp, y = Ozone)) +
geom_point() +
stat_smooth(method = "loess")
p12
p12 <- ggplot(airquality, aes(x = Temp, y = Ozone)) +
geom_point() +
geom_smooth(method = lm)
p12
m1 <- summary(lm(Ozone ~ Temp, data = airquality))
m1$adj.r.squared
p12 <- ggplot(airquality, aes(x = Temp, y = Ozone)) +
geom_point(shape = 1) +
stat_smooth(method = "lm", formula = y ~ x + I(x^2))
p12
m2 <- summary(lm(Ozone ~ Temp + I(Temp^2), data = airquality))
m2$adj.r.squared
# Changing the width of the bins
p12 <- ggplot(airquality, aes(x = Temp, y = Ozone)) +
geom_point() +
geom_smooth(method = "loess", n = 5)
p12
# Customising axis labels
p12 <- ggplot(airquality, aes(x = Temp, y = Ozone)) +
geom_point() +
stat_smooth(method = "loess") +
scale_x_continuous(name = "Temperature") +
scale_y_continuous(name = "Mean ozone in parts per billion")
p12
p12 <- p12 + scale_y_continuous(name = "Mean ozone in\nparts per billion")
p12
# Changing axis ticks
p12 <- p12 + scale_y_continuous(name = "Mean ozone in\nparts per billion",
breaks = seq(0, 150, 25), limits = c(0, 150))
p12
# Adding a title
p12 <- p12 +
labs(title = "LOWESS plot of mean ozone by month",
subtitle = "Source: New York State Department of Conservation")
p12
# Changing the colour and size of the LOWESS curve
fill <- "gold1"
p12 <- ggplot(airquality, aes(x = Temp, y = Ozone)) +
geom_point() +
geom_smooth(method = "loess", colour = fill) +
scale_x_continuous(name = "Temperature") +
scale_y_continuous(name = "Mean ozone in\nparts per billion",
breaks = seq(0, 150, 25), limits = c(0, 150)) +
labs(title = "LOWESS plot of mean ozone by month",
subtitle = "Source: New York State Department of Conservation")
p12
fill <- "#4271AE"
p12 <- ggplot(airquality, aes(x = Temp, y = Ozone)) +
geom_point() +
geom_smooth(method = "loess", colour = fill) +
scale_x_continuous(name = "Temperature") +
scale_y_continuous(name = "Mean ozone in\nparts per billion",
breaks = seq(0, 150, 25), limits = c(0, 150)) +
labs(title = "LOWESS plot of mean ozone by month",
subtitle = "Source: New York State Department of Conservation")
p12
fill <- "#4271AE"
p12 <- ggplot(airquality, aes(x = Temp, y = Ozone)) +
geom_point() +
geom_smooth(method = "loess", colour = fill, size = 1.5) + # 增加线条厚度
scale_x_continuous(name = "Temperature") +
scale_y_continuous(name = "Mean ozone in\nparts per billion",
breaks = seq(0, 150, 25), limits = c(0, 150)) +
labs(title = "LOWESS plot of mean ozone by month",
subtitle = "Source: New York State Department of Conservation")
p12
# Changing the appearance of the confidence interval
fill <- "#4271AE"
p12 <- ggplot(airquality, aes(x = Temp, y = Ozone)) +
geom_point() +
geom_smooth(method = "loess", colour = fill, size = 1.5, alpha = 0.2) +
scale_x_continuous(name = "Temperature") +
scale_y_continuous(name = "Mean ozone in\nparts per billion",
breaks = seq(0, 150, 25), limits = c(0, 150)) +
labs(title = "LOWESS plot of mean ozone by month",
subtitle = "Source: New York State Department of Conservation")
p12
fill <- "#4271AE"
p12 <- ggplot(airquality, aes(x = Temp, y = Ozone)) +
geom_point() +
geom_smooth(method = "loess", colour = fill, size = 1.5,
alpha = 0.2, fill = fill) +
scale_x_continuous(name = "Temperature") +
scale_y_continuous(name = "Mean ozone in\nparts per billion",
breaks = seq(0, 150, 25), limits = c(0, 150)) +
labs(title = "LOWESS plot of mean ozone by month",
subtitle = "Source: New York State Department of Conservation")
p12
fill <- "#4271AE"
p12 <- ggplot(airquality, aes(x = Temp, y = Ozone)) +
geom_point() +
geom_smooth(method = "loess", colour = fill, size = 1.5, se = FALSE) +
scale_x_continuous(name = "Temperature") +
scale_y_continuous(name = "Mean ozone in\nparts per billion",
breaks = seq(0, 150, 25), limits = c(0, 150)) +
labs(title = "LOWESS plot of mean ozone by month",
subtitle = "Source: New York State Department of Conservation")
p12
# Changing the appearance of the scatterplot
fill <- "#4271AE"
p12 <- ggplot(airquality, aes(x = Temp, y = Ozone)) +
geom_point(shape = 21, colour = "darkblue") +
geom_smooth(method = "loess", colour = fill, size = 1.5,
alpha = 0.2, fill = fill) +
scale_x_continuous(name = "Temperature") +
scale_y_continuous(name = "Mean ozone in\nparts per billion",
breaks = seq(0, 150, 25), limits = c(0, 150)) +
labs(title = "LOWESS plot of mean ozone by month",
subtitle = "Source: New York State Department of Conservation")
p12
fill <- "#4271AE"
p12 <- ggplot(airquality, aes(x = Temp, y = Ozone)) +
geom_smooth(method = "loess", colour = fill, size = 1.5,
alpha = 0.2, fill = fill) +
scale_x_continuous(name = "Temperature") +
scale_y_continuous(name = "Mean ozone in\nparts per billion",
breaks = seq(0, 125, 25), limits = c(0, 125)) +
labs(title = "LOWESS plot of mean ozone by month",
subtitle = "Source: New York State Department of Conservation")
p12
# Using the white theme
fill <- "#4271AE"
p12 <- ggplot(airquality, aes(x = Temp, y = Ozone)) +
geom_point(shape = 21, colour = "darkblue") +
geom_smooth(method = "loess", colour = fill, size = 1.5,
alpha = 0.2, fill = fill) +
scale_x_continuous(name = "Temperature") +
scale_y_continuous(name = "Mean ozone in\nparts per billion",
breaks = seq(0, 150, 25), limits = c(0, 150)) +
labs(title = "LOWESS plot of mean ozone by month",
subtitle = "Source: New York State Department of Conservation") +
theme_bw()
p12
# Using ‘The Economist’ theme
p12 = ggplot(airquality, aes(x = Temp, y = Ozone)) +
geom_point(shape = 21, colour = "#1F3552") +
geom_smooth(method = "loess", colour = "#4271AE", size = 1.5,
alpha = 0.2, fill = "#4271AE") +
scale_x_continuous(name = "Temperature") +
scale_y_continuous(name = "Mean ozone in\nparts per billion",
breaks = seq(0, 150, 25), limits = c(0, 150)) +
labs(title = "LOWESS plot of mean ozone by month",
subtitle = "Source: New York State Department of Conservation") +
theme_economist() + scale_fill_economist() +
theme(axis.line.x = element_line(size = .5, colour = "black"),
axis.title = element_text(size = 12),
legend.position = "bottom",
legend.direction = "horizontal",
legend.box = "horizontal",
legend.text = element_text(size = 10),
text = element_text(family = "Roboto Condensed"),
plot.title = element_text(family = "Roboto Condensed"))
p12
# Using ‘Five Thirty Eight’ theme
p12 = ggplot(airquality, aes(x = Temp, y = Ozone)) +
geom_point(shape = 21, colour = "red") +
geom_smooth(method = "loess", colour = "dodgerblue", size = 1.5,
alpha = 0.2, fill = "dodgerblue") +
scale_x_continuous(name = "Temperature") +
scale_y_continuous(name = "Mean ozone in\nparts per billion",
breaks = seq(0, 150, 25), limits = c(0, 150)) +
labs(title = "LOWESS plot of mean ozone by month",
subtitle = "Source: New York State Department of Conservation") +
theme_fivethirtyeight() + scale_fill_fivethirtyeight() +
theme(axis.title = element_text(family = "Atlas Grotesk Regular", size = 12),
legend.position = "bottom",
legend.direction = "horizontal",
legend.box = "horizontal",
legend.title = element_text(family = "Atlas Grotesk Regular", size = 8),
legend.text = element_text(family = "Atlas Grotesk Regular", size = 8),
plot.title = element_text(family = "Atlas Grotesk Medium", size = 16),
text = element_text(family = "Decima Mono Pro"))
p12
# my own
fill = "#4271AE"
p12 = ggplot(airquality, aes(x = Temp, y = Ozone)) +
geom_point(shape = 21, colour = "darkblue") +
geom_smooth(method = "loess", colour = fill, size = 1.5,
alpha = 0.2, fill = fill) +
scale_x_continuous(name = "Temperature") +
scale_y_continuous(name = "Mean ozone in\nparts per billion",
breaks = seq(0, 150, 25), limits = c(0, 150)) +
labs(title = "LOWESS plot of mean ozone by month",
subtitle = "Source: New York State Department of Conservation") +
theme_bw() +
theme(panel.border = element_rect(colour = "black", fill = NA, size = .5),
panel.grid.major = element_line(colour = "#d3d3d3"),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
plot.title = element_text(size = 13, family = "Tahoma", face = "bold"),
text = element_text(family = "Tahoma"),
axis.title = element_text(face = "bold", size = 10),
axis.text.x = element_text(colour = "black", size = 8),
axis.text.y = element_text(colour = "black", size = 8))
p12
